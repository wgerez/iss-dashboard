@extends('layouts.master')@section('customstyle')	<link rel="stylesheet" type="text/css" href="{{url('assets/global/plugins/select2/select2.css')}}"/>	<link rel="stylesheet" type="text/css" href="{{url('assets/global/plugins/datatables/extensions/Scroller/css/dataTables.scroller.min.css')}}"/>	<link rel="stylesheet" type="text/css" href="{{url('assets/global/plugins/datatables/extensions/ColReorder/css/dataTables.colReorder.min.css')}}"/>	<link rel="stylesheet" type="text/css" href="{{url('assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css')}}"/>@stop@section('content')	<!-- COMIENZO CONTENIDO -->	<div class="page-content-wrapper">		<div class="page-content">			<!-- COMIENZO DEL HEADER-->			<div class="row">				<div class="col-md-12">					<!-- COMIENZO TITULO & BREADCRUMB-->					<h3 class="page-title">					Informes <small>legajos de alumnos (pdf)</small>					</h3>					<ul class="page-breadcrumb breadcrumb">						<li>							<i class="fa fa-home"></i>							<a href="{{url('dashboard')}}">Inicio</a>							<i class="fa fa-angle-right"></i>						</li>						<li>							<a href="{{url('informes/alumnos')}}">Informes</a>							<i class="fa fa-angle-right"></i>						</li>						<li>							<a href="{{url('alumnos/listado')}}">Alumnos</a>						</li>					</ul>					<!-- FIN DE TITULO & BREADCRUMB-->				</div>			</div>			<!-- FIN DE HEADER-->			<!-- COMIENZO DEL CONTENIDO-->			<div class="row">				<div class="col-md-12">					<!-- COMIENZO DE LA TABLA-->					<div class="portlet">						<div class="portlet-title">							<div class="caption">								<i class="fa fa-users"></i>Legajos de Alumnos							</div>							<!--div class="actions">								<a href="{{url('alumnos/crear')}}" @if (!$editar) {{'DISABLED'}} @endif class="btn default blue-stripe" >								<i class="fa fa-plus"></i>								<span class="hidden-480">								Nuevo</span>								</a>								<a href="{{url('alumnos/listado')}}" class="btn default yellow-stripe">								<i class="fa fa-refresh"></i>								<span class="hidden-480">								Actualizar </span>								</a>							</div -->						</div>						<div class="portlet-body">							<div class="form-body">								{{ Form::open(array('class'=>'form-horizontal form-row-seperated','name'=>'FrmAlumnos'))}}								<div class="form-group">									<label  class="col-md-2 col-sm-2 control-label" for="organizacion">Organizaci&oacute;n:</label>									<div class="col-md-6 col-sm-10">										{{ Form::select('cboOrganizacion', $organizaciones, Input::old('cboOrganizacion'), array('class'=>'table-group-action-input form-control','id'=>'cboOrganizacion')) }}									</div>								</div>								<div class="form-group">									<label class="col-md-2 col-sm-2 control-label" for="filtro">Ciclo Lectivo:</label>									<div class="col-md-2 col-sm-3">										<select name="cboCiclo" id="cboCiclo" class="table-group-action-input form-control">										</select>									</div>																		<label class="col-md-2 col-sm-2 control-label" for="legajo">Legajo:</label>									<div class="col-md-2 col-sm-2">										<select name="cboLegajo" id="cboLegajo" class="table-group-action-input form-control">											<option value='0'>Seleccionar</option>											<option value='1'>Completo</option>											<option value='2'>Incompleto</option>										</select>									</div>								</div>								<div class="form-group">									<label class="col-md-2 col-sm-2 control-label" for="filtro">Carreras:</label>									<div class="col-md-6 col-sm-10">										<select name="cboCarreras" id="cboCarreras" class="table-group-action-input form-control">										</select>									</div>																	<div class="col-md-2 col-sm-2">										<button class="btn btn-primary" type="button" id='btnBuscar'>											<i class="fa fa-search"></i> Buscar										</button>									</div>																		<div id="divbtnImprimir" class="col-md-2 col-sm-2">										<a target="_blank" href="#" id="imprimir" class="btn btn-success"><i class="fa fa-print"></i> Imprimir</a>									</div>								</div>								<div class='form-group'>									<label class="col-md-2 col-sm-2 control-label" for="filtro">Filtrar por:</label>									<div class="col-md-2 col-sm-3">										<select name="cboFiltros" id="cboFiltros" class="table-group-action-input form-control">											<option value='0'>Seleccionar</option>											<option value='1'>DNI</option>											<option value='2'>Apellido</option>										</select>									</div>									<div class="col-md-4 col-sm-7">										<input type='text' name="txtFiltro" id="txtFiltro" class="table-group-action-input form-control">									</div>									<div class="col-md-2 col-sm-2">										<button class="btn btn-primary" type="button" id='btnFiltrar'>											<i class="fa fa-search"></i> Filtrar										</button>									</div>									<div id="divbtnImprimirFiltrar" class="col-md-2 col-sm-2">										<a target="_blank" href="#" id="imprimir_filtrar" class="btn btn-success"><i class="fa fa-print"></i> Imprimir</a>									</div>								</div>								{{ Form::close() }}								<br>								<div class="form-group" align='center'>									<small>										DNI = Fotocopia DNI | Fotos = 3 fotos 4x4 | PN = Partida de Nacimiento | FM = Ficha M&eacute;dica | CV = Constancia de Vacunaci&oacute;n <br>										FP = Ficha de Preinscripci&oacute;n | FTS = Fotocopia T&iacute;tulo Secundario | CTT = Constancia de T&iacute;tulo en Tr&aacute;mite | CT = Constancia de Trabajo | S = Seguro | FVS = Fecha Vencimiento Seguro									</small>							    </div>								<table class="table table-striped table-bordered table-hover" id="table_informes">									<thead>										<tr>											<th><center>Apellido y Nombre</center></th>											<th><center>DNI</center></th>											<th><center>Fotos</center></th>											<th><center>PN</center></th>											<th><center>FM</center></th>											<th><center>CV</center></th>											<th><center>FP</center></th>											<th><center>FTS</center></th>											<th><center>CTT</center></th>											<th><center>CT</center></th>											<th><center>S</center></th>											<th><center>FVS</center></th>											<th><center>Otros</center></th>										</tr>									</thead>									<tbody>									</tbody>								</table>							</div>												</div>					</div>					<!-- FIN DE LA TABLA-->				</div>			</div>			<!-- FIN DEL CONTENIDO -->		</div>	</div>	<!-- FIN -->	<!-- MODAL DE ALERTAS-->	<div class="modal fade" id="modalalerta" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">			<div class="modal-dialog">				<div class="modal-content">					<div class="modal-header">						<button type="button" class="close" data-dismiss="modal" aria-hidden="true"></button>						<h4 class="modal-title"><i class="fa fa-info-circle"></i> Aviso</h4>					</div>					<div class="modal-body">					<p id="txtalerta"></p>					</div>					<div class="modal-footer">						<button data-dismiss="modal" type="button" class="btn default"><i class="fa fa-times-circle-o"></i> Cerrar</button>					</div>				</div>			</div>	</div>	<!-- FIN MODAL DE ALERTAS-->		@stop@section('customjs')	$('#divbtnImprimir').hide();	$('#divbtnImprimirFiltrar').hide();    /* DESHABILITO EL ENTER EN EL CONTROL */	$('#txtFiltro').keypress(function(e) {	    if (e.which == 13)	        return false;	});    $('#btnFiltrar').click(function() {    	limpiar_tabla();    	$('#divbtnImprimir').hide();    	$('#divbtnImprimirFiltrar').hide();    	var filtro_opcion = $('#cboFiltros').val();    	var filtro = $('#txtFiltro').val();    	if (filtro_opcion == 0 || filtro == '') {    		$('#txtalerta').text('Debe seleccionar la Opción e ingresar un valor');    		$('#modalalerta').modal('show');    	    return;    	}    	var url_informe = '';    	if (filtro_opcion == 1) { //DNI    		url_informe = '{{url('alumnos/informelegajospordni')}}';    	} else if (filtro_opcion == 2) { // APELLIDO    		url_informe = '{{url('alumnos/informelegajosporapellido')}}';    	}		$.ajax({		  url: url_informe,		  data:{'filtro': filtro},		  type: 'POST'		}).done(function(legajos) {			console.log(legajos);			if (legajos.length == 0) {    			$('#txtalerta').text('No se ha encontrado Alumnos');    			$('#modalalerta').modal('show');				return;			}			$('#divbtnImprimirFiltrar').show();			var ok = "<i class='fa fa-check text-success'></i>";			var falta = "<i class='fa fa-times text-danger'></i>";			$.each(legajos, function(key, legajo) {			    persona = legajo.apellido + ', ' + legajo.nombre;			    dni  = (legajo.dni == "1") ? ok : falta;			    foto = (legajo.foto == "1") ? ok : falta;			    partida_nacimiento = (legajo.partidanacimiento == "1") ? ok : falta;			    certificado_buena_salud = (legajo.certificadobuenasalud == "1") ? ok : falta;			    certificado_vacunacion = (legajo.certificadovacinacion == "1") ? ok : falta;			    ficha_preinscripcion = (legajo.fichapreinscripcion == "1") ? ok : falta;			    titulo_secundario = (legajo.titulosecundario == "1") ? ok : falta;			    titulo_tramite = (legajo.constitulotramite == "1") ? ok : falta;			    constancia_trabajo = (legajo.constanciatrabajo == "1") ? ok : falta;			    seguro = (legajo.seguro == "1") ? ok : falta;			    otros = (legajo.otros == "1") ? ok : falta;			    var fecha_vencimiento = '';			    			    if (legajo.seguro == "1") {			    	fecha_vencimiento = getFechaImpresion(legajo.fechavencimientoseguro);			    }				$('#table_informes > tbody').append(				    '<tr>' +				    '<td><center>' + persona + '</center></td>' +				    '<td><center>' + dni + '</center></td>' +				    '<td><center>' + foto + '</center></td>' +				    '<td><center>' + partida_nacimiento + '</center></td>' +				    '<td><center>' + certificado_buena_salud + '</center></td>' +				    '<td><center>' + certificado_vacunacion + '</center></td>' +				    '<td><center>' + ficha_preinscripcion + '</center></td>' +				    '<td><center>' + titulo_secundario + '</center></td>' +				    '<td><center>' + titulo_tramite + '</center></td>' +				    '<td><center>' + constancia_trabajo + '</center></td>' +				    '<td><center>' + seguro + '</center></td>' +				    '<td><center>' + fecha_vencimiento + '</center></td>' +				    '<td><center>' + otros + '</center></td>' +				    '</tr>'				);			});		}).error(function(data) {			console.log(data);		});    });    $('#btnBuscar').click(function() {    	limpiar_tabla();    	$('#divbtnImprimir').hide();    	$('#divbtnImprimirFiltrar').hide();    	var organizacion = $('#cboOrganizacion').val();    	var carrera = $('#cboCarreras').val();    	var cboCiclo = $('#cboCiclo').val();    	var cboLegajo = $('#cboLegajo').val();    	if (organizacion == 0 || carrera == 0 || cboCiclo == 0) {    		$('#txtalerta').text('Debe seleccionar Organización y Carrera');    		$('#modalalerta').modal('show');    	        	    return;    	}    	if (cboLegajo == 0) {    		$('#txtalerta').text('Debe seleccionar tipo de busqueda de Legajo');    		$('#modalalerta').modal('show');    	        	    return;    	}		$.ajax({		  url: '{{url('alumnos/informelegajosporcarrera')}}',		  data:{'carrera': carrera, 'cboCiclo': cboCiclo, 'cboLegajo': cboLegajo},		  type: 'POST'		}).done(function(legajos) {			console.log(legajos);			if (legajos.length == 0) {    			$('#txtalerta').text('No se ha encontrado Alumnos');    			$('#modalalerta').modal('show');								return;			}			$('#divbtnImprimir').show();			var ok = "<i class='fa fa-check text-success'></i>";			var falta = "<i class='fa fa-times text-danger'></i>";			$.each(legajos, function(key, legajo) {			    persona = legajo.apellido + ', ' + legajo.nombre;			    dni  = (legajo.dni == "1") ? ok : falta;			    foto = (legajo.foto == "1") ? ok : falta;			    partida_nacimiento = (legajo.partidanacimiento == "1") ? ok : falta;			    certificado_buena_salud = (legajo.certificadobuenasalud == "1") ? ok : falta;			    certificado_vacunacion = (legajo.certificadovacinacion == "1") ? ok : falta;			    ficha_preinscripcion = (legajo.fichapreinscripcion == "1") ? ok : falta;			    titulo_secundario = (legajo.titulosecundario == "1") ? ok : falta;			    titulo_tramite = (legajo.constitulotramite == "1") ? ok : falta;			    constancia_trabajo = (legajo.constanciatrabajo == "1") ? ok : falta;			    seguro = (legajo.seguro == "1") ? ok : falta;			    otros = (legajo.otros == "1") ? ok : falta;			    var fecha_vencimiento = '';			    			    if (legajo.seguro == "1") {			    	fecha_vencimiento = getFechaImpresion(legajo.fechavencimientoseguro);			    }				$('#table_informes > tbody').append(				    '<tr>' +				    '<td><center>' + persona + '</center></td>' +				    '<td><center>' + dni + '</center></td>' +				    '<td><center>' + foto + '</center></td>' +				    '<td><center>' + partida_nacimiento + '</center></td>' +				    '<td><center>' + certificado_buena_salud + '</center></td>' +				    '<td><center>' + certificado_vacunacion + '</center></td>' +				    '<td><center>' + ficha_preinscripcion + '</center></td>' +				    '<td><center>' + titulo_secundario + '</center></td>' +				    '<td><center>' + titulo_tramite + '</center></td>' +				    '<td><center>' + constancia_trabajo + '</center></td>' +				    '<td><center>' + seguro + '</center></td>' +				    '<td><center>' + fecha_vencimiento + '</center></td>' +				    '<td><center>' + otros + '</center></td>' +				    '</tr>'				);			});		}).error(function(data) {			console.log(data);		});    });    $('#cboCiclo').change(function() {        $('#cboCarreras').children().remove().end();		limpiar_tabla();        if ($('#cboCiclo').val() == 0) return;		$.ajax({		  url: '{{url('inscripciones/obtenercarrerasporciclo')}}',		  data:{'ciclo_lectivo_id': $('#cboCiclo').val()},		  type: 'POST'		}).done(function(carreras) {			console.log(carreras);			if (carreras == <?php echo InscripcionesController::NO_TIENE_INSCRIPCION  ?>) {				alert('Este Ciclo Lectivo no tiene Carreras con Alumnos inscritos');				return;			}			$('#cboCarreras').append(		        $('<option></option>').val(0).html('Seleccionar')		    );			$.each(carreras, function(key, value) {				$('#cboCarreras').append(			        $('<option></option>').val(value.carrera_id).html(value.carrera)			    );			});		}).error(function(data) {			console.log(data);		});    });    $('#cboCarreras').change(function() {    	$('#divbtnImprimir').hide();    	$('#divbtnImprimirFiltrar').hide();    	limpiar_tabla();    });    $('#cboOrganizacion').change(function() {    	$('#divbtnImprimir').hide();    	$('#divbtnImprimirFiltrar').hide();    	limpiar_tabla();    	//////////////////////////////////		$('#cboCiclo').children().remove().end();		$('#cboCarrera').children().remove().end();		if ($('#cboOrganizacion').val() == 0) return;		$.ajax({		  url: '{{url('ciclolectivo/obtenercicloslectivos')}}',		  data:{'organizacion_id': $('#cboOrganizacion').val()},		  type: 'POST'		}).done(function(ciclos) {			console.log(ciclos);			if (ciclos == <?php echo CicloLectivoController::NO_EXISTE_CICLO ?>) {				alert('La Organización no tiene Ciclos Lectivos Asignados');				return;		    }			$('#cboCiclo').append(		        $('<option></option>').val(0).html('Seleccionar')		    );			$.each(ciclos, function(key, value) {				$('#cboCiclo').append(			        $('<option></option>').val(value.id).html(value.descripcion)			    );			});		}).error(function(data) {			console.log(data);		});		////////////////////////////////////////////////////		/*$('#cboCarreras').children().remove().end();		if ($('#cboOrganizacion').val() == 0) return;		$.ajax({		  url: '{{url('organizacions/obtenercarrerasconmatricula')}}',		  data:{'organizacion_id': $('#cboOrganizacion').val()},		  type: 'POST'		}).done(function(carreras) {			console.log(carreras);			if (carreras == <?php echo OrganizacionsController::NO_TIENE_CARRERAS ?>) {    			$('#txtalerta').text('La Organización no tiene Carreras asignadas');    			$('#modalalerta').modal('show');								return;		    }			if (carreras == <?php echo OrganizacionsController::NO_TIENE_CARRERAS_CON_MATRICULA_ASOCIADA ?>) {    			$('#txtalerta').text('No existen Carreras con Matrículas asignadas');    			$('#modalalerta').modal('show');								return;		    }			$('#cboCarreras').append(		        $('<option></option>').val(0).html('Seleccionar')		    );			$.each(carreras, function(key, value) {				$('#cboCarreras').append(			        $('<option></option>').val(value.id).html(value.carrera)			    );			});		}).error(function(data) {			console.log(data);		});*/    });    function limpiar_tabla() {	    var n = 0;		$('#table_informes tr').each(function() {		   if (n > 0) $(this).remove();		   n++;		});    }	$('#imprimir').on('click', function(e){		e.preventDefault();		window.open("{{url('alumnos/pdflegajosalumnosporcarrera')}}?carrera=" + $('#cboCarreras').val() + '&cboCiclo=' + $('#cboCiclo').val() + '&cboLegajo=' + $('#cboLegajo').val());	});	$('#imprimir_filtrar').on('click', function(e){		e.preventDefault();		window.open("{{url('alumnos/pdflegajosalumnosporfiltro')}}?filtro=" + $('#cboFiltros').val() + '&valor=' + $('#txtFiltro').val());	});@stop@section('includejs')	<script type="text/javascript" src="{{url('assets/global/plugins/select2/select2.min.js')}}"></script>	<script type="text/javascript" src="{{url('assets/global/plugins/datatables/media/js/jquery.dataTables.min.js')}}"></script>	<script type="text/javascript" src="{{url('assets/global/plugins/datatables/extensions/TableTools/js/dataTables.tableTools.min.js')}}"></script>	<script type="text/javascript" src="{{url('assets/global/plugins/datatables/extensions/ColReorder/js/dataTables.colReorder.min.js')}}"></script>	<script type="text/javascript" src="{{url('assets/global/plugins/datatables/extensions/Scroller/js/dataTables.scroller.min.js')}}"></script>	<script type="text/javascript" src="{{url('assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.js')}}"></script>	<script src="{{url('assets/admin/pages/scripts/getFechaImpresion.js')}}"></script>	<script src="{{url('assets/admin/pages/scripts/helpers/jquery.combodinamico.js')}}" type="text/javascript"></script>@stop